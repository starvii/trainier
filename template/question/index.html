<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>questions</title>
    <link rel="stylesheet" href="/bulma/bulma.min.css">
    <link rel="stylesheet" href="/fontawesome/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
{% raw %}
<div class="container" id="app">
    <div class="columns"></div>
    <div class="column">
        <table class="table is-striped is-narrow is-fullwidth is-hoverable">
            <thead>
            <tr>
                <th>编号</th>
                <th>题目（英文）</th>
                <th>题目（中文）</th>
                <th><a class="button is-small">
                    <span class="icon is-small">
                        <i class="fas fa-plus"></i>
                    </span>
                </a></th>
            </tr>
            </thead>
            <tbody>

            </tbody>
            <tfoot>
                <page-component v-bind:conf.sync="pageConf"></page-component>
            </tfoot>
        </table>
    </div>
</div>
<script src="/vue/vue.js"></script>
<script src="/vue/resource/vue-resource.js"></script>
<script src="/js/page.js"></script>
<script>
    const app = new Vue({
        el: '#app',
        data: {
            data: [],
            pageConf: {
                currentPage: 1,
                totalItems: 1000,
                itemsPerPage: 10,
                pagesLength: 9,
                perPageOptions: [10, 15, 30, 50, 100],
                onChange: 'list',
            },
            keyword: '',
            kw: '',
        },
        methods: {
            list: function () {
                Vue.http.post(
                    '/api/q/',
                    {
                        page: this.pageConf.currentPage,
                        size: this.pageConf.itemsPerPage,
                        keyword: this.keyword,
                    },
                ).then(
                    function (response) {
                        if (response.ok) {
                            let t = response.body;
                            app.pageConf.currentPage = t.page;
                            app.pageConf.totalItems = t.total;
                            app.pageConf.itemsPerPage = t.size;
                            app.data = t.data;
                        } else {
                            alert('请求服务失败，请检查日志');
                        }

                    },
                    function (response) {
                        alert('请求服务失败，请检查日志');
                    }
                );
            },
            save: function () {
                Vue.http.post(
                    '/api/import/save',
                    {
                        entityId: app.trunkId,
                        comment: app.comment,
                        analysis: app.analysis,
                        source: app.source,
                        enTrunk: app.enTrunk,
                        cnTrunk: app.cnTrunk,
                        level: 0,
                        options: app.options,
                    }
                ).then(
                    function (response) {
                        if (response.ok) {
                            alert('保存成功');
                        } else {
                            alert('保存失败，请检查日志');
                        }

                    },
                    function (response) {
                        alert('保存失败，请检查日志');
                    }
                );
            },
            changeAnswer: function (index) {
                app.options[index].isTrue = !app.options[index].isTrue;
            },
            changeOptionNumber: function () {
                var num = parseInt(app.number);
                app.options = [];
                for (var i = 0; i < num; i++) {
                    app.options.push({
                        enOption: '',
                        cnOption: '',
                        isTrue: false,
                    });
                }
            },
        },
    });
</script>

{% endraw %}
</body>
</html>